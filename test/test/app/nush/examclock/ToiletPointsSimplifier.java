package test.app.nush.examclock;

import test.app.nush.examclock.simplify.Point;
import test.app.nush.examclock.simplify.Simplify;

import javax.swing.*;
import java.awt.*;
import java.awt.geom.Ellipse2D;
import java.awt.geom.Path2D;
import java.util.Arrays;
import java.util.stream.Collectors;

public class ToiletPointsSimplifier {
    static final double[][] WOMAN = {{124.50539, 388.1627288800347}, {124.50539, 398.15665123338783}, {124.50539000000002, 408.1616777061044}, {124.50539, 418.1566880031125}, {124.50539, 428.1592573948896}, {124.50539000000002, 438.15563866916887}, {124.50539, 448.1576300344629}, {124.50539, 458.15275771072606}, {124.50538999999999, 468.1537391928527}, {124.50539, 478.1525352862232}, {124.50539, 488.15745398592804}, {124.50538999999999, 498.1580706607869}, {124.50539, 508.1552378347063}, {124.50539, 518.1609986606489}, {124.50539, 528.1636780280936}, {124.50539, 538.1548573968887}, {124.50539, 548.1579427936456}, {123.18739424721308, 558.0036274869751}, {117.77319884720687, 566.29963892788}, {109.1066209843476, 571.0958107129287}, {99.20549128758665, 571.8390144254398}, {89.83892938733801, 568.5230514436173}, {82.99814975855827, 561.3799047938537}, {80.19406109869544, 551.8642842838627}, {80.108304, 541.8669505325109}, {80.108304, 531.8569121987605}, {80.10830400000002, 521.869334537953}, {80.10830400000002, 511.86745450863015}, {80.108304, 501.8719617277812}, {80.108304, 491.8636000143371}, {80.108304, 481.8554929383535}, {80.108304, 471.8573187230828}, {80.108304, 461.8652754804116}, {80.108304, 451.86959497721034}, {80.108304, 441.8751047510066}, {80.108304, 431.8699705814476}, {80.108304, 421.8594595325942}, {80.108304, 411.8607074381748}, {80.108304, 401.86597379686896}, {80.108304, 391.8589445962029}, {73.81376968259649, 388.15533999999997}, {63.826377753449506, 388.15533999999997}, {53.81232889776624, 388.15534}, {43.80755915051042, 388.1553400000001}, {33.81632464654457, 388.15534}, {23.816066399742123, 388.15534}, {25.288201748181997, 379.4941224248968}, {28.025833528340122, 369.88062233536755}, {30.766231324536804, 360.2574090712519}, {33.5047371223801, 350.64083977089774}, {36.24130868786334, 341.03106274374153}, {38.98184836508795, 331.4073512485327}, {41.722452759182914, 321.78341249279754}, {44.45785244264281, 312.177750660394}, {47.199688785615265, 302.5494857784319}, {49.93939096244526, 292.92871525949926}, {52.67747376076661, 283.31363136926177}, {55.416542378348225, 273.6950856644678}, {58.154077719650154, 264.081924230765}, {60.89225896658665, 254.46649462720796}, {63.63070761404366, 244.85012601682513}, {66.36987582546556, 235.23123057712553}, {69.10783802584433, 225.61657018004738}, {71.84973291885112, 215.98809969309323}, {74.58719874010865, 206.37518238679937}, {77.32540952149806, 196.75964906970864}, {80.06212783105735, 187.149356734322}, {82.8049664495934, 177.51757224965434}, {80.25481180157081, 171.89962}, {73.22892884842479, 175.85805962432445}, {70.43697517277207, 185.46233053694198}, {67.64516590463161, 195.0661046902895}, {64.85532659933716, 204.6631022065367}, {62.06416640418506, 214.26464356036595}, {59.27007432986899, 223.87627052629514}, {56.477591999999994, 233.48236}, {53.68835196824507, 243.0772960259458}, {50.89728148176097, 252.678528783555}, {48.10572884573633, 262.28142012699544}, {45.31527467373684, 271.8805327737557}, {42.52250362746226, 281.487615426753}, {39.73128896245341, 291.08934415591915}, {36.187018574454065, 300.4105865278466}, {29.427037755947318, 307.6506449501714}, {20.018872550934947, 310.6598500394191}, {10.359946995266693, 308.511296406636}, {3.0911452761709546, 301.81318963266176}, {0.09665425993622279, 292.37948664557223}, {1.2460772927347887, 282.49472937190285}, {4.12724263725402, 272.9157779389362}, {7.0102727088362204, 263.34003854101985}, {9.892679151051755, 253.76637047505216}, {12.776835250899495, 244.18689106993588}, {15.657283984542685, 234.6197253666354}, {18.541875405111096, 225.03880008073668}, {21.422614691750784, 215.47066933034802}, {24.30638068136277, 205.89248564323026}, {27.188987273275295, 196.31815279705168}, {30.069297235434142, 186.75144801144435}, {32.95394546693757, 177.17033403285245}, {35.83767143116542, 167.592283286647}, {38.722968341955635, 158.00901477492542}, {41.60802678014994, 148.4425950877953}, {45.62888871718502, 139.30276682508557}, {51.105934668471335, 130.95065586966257}, {57.73691615654539, 123.47826022922642}, {65.40371372786066, 117.06537694505047}, {73.98442005491, 111.94686476907759}, {83.29423381675383, 108.34447897411772}, {93.09426279377635, 106.38962668364435}, {103.06754051430185, 106.02037}, {113.08149921457355, 106.02037}, {123.07412662013354, 106.02037000000001}, {133.08561500693145, 106.02037}, {143.08007766432706, 106.02037}, {153.07020085073768, 106.02036999999999}, {163.0752387963867, 106.02037}, {172.9993215432036, 107.07074512260199}, {182.59357835998418, 109.87107295804564}, {191.54315005774066, 114.29800569941314}, {199.65768063144333, 120.11623253885107}, {206.8436966265822, 127.0723058924748}, {213.02159793001266, 134.92235307219912}, {218.09862639491513, 143.52873843800413}, {221.62803915289072, 152.86326852681668}, {224.51220677086542, 162.4427800490134}, {227.3939062182345, 172.0140937575297}, {230.27653582104176, 181.58849689631407}, {233.16225970864474, 191.17317743252477}, {236.0432763095755, 200.7422231260745}, {238.92617012742704, 210.31750383211454}, {241.8095481642942, 219.89439282943778}, {244.69059650151445, 229.46354393230865}, {247.57611234276703, 239.0475334606879}, {250.4581190614815, 248.61986774421362}, {253.33971615038885, 258.19084147801505}, {256.2218963419356, 267.7637519364428}, {259.11011790191105, 277.356728273883}, {261.53835224290765, 287.0265414932651}, {260.7824492433326, 296.92582943621613}, {255.69915213883635, 305.41896629824043}, {247.10397535327706, 310.32272102644}, {237.23216901208247, 310.2162115003353}, {228.8624509881492, 304.9671400445472}, {223.78698353222657, 296.42458677653985}, {220.93387804564648, 286.840610945202}, {218.14241764577937, 277.23803581971026}, {215.35084628453004, 267.63507898899735}, {212.55804941663808, 258.02790643679225}, {209.7695942384479, 248.43566922149336}, {206.97796759385935, 238.83252221705703}, {204.18448927246885, 229.22300547669334}, {201.39545482868755, 219.62877559785667}, {198.60407233485256, 210.02646846775744}, {195.81353798718305, 200.42707894568588}, {193.02188846811958, 190.82385325345447}, {190.2264333383958, 181.2075363268765}, {187.21417436695577, 171.89962}, {177.2249504789752, 171.89962000000003}, {178.5384278900711, 180.39373033588387}, {181.3343148860841, 189.98865618812897}, {184.13229386415406, 199.59076130504013}, {186.9318800486674, 209.19838203351767}, {189.72697300282417, 218.7905828926765}, {192.52209279353812, 228.38287584954048}, {195.32308945239433, 237.99533704430135}, {198.11957780783086, 247.59232664200093}, {200.91771328361162, 257.19496882780413}, {203.714172923946, 266.7918598810074}, {206.50957248735983, 276.3851129619087}, {209.3124444038462, 286.0040096663812}, {212.1087676831651, 295.60043275580944}, {214.90668871616816, 305.20233901682224}, {217.70050928830793, 314.7901733149841}, {220.50210070372634, 324.404675595498}, {223.29910442756392, 334.00343383463473}, {226.09338730352948, 343.5928546672079}, {228.89279079423676, 353.1998484270256}, {231.68786346199923, 362.7919796673302}, {234.48952799724782, 372.4067328804998}, {237.28577305656788, 382.0028875345121}, {235.49382031501753, 388.15534}, {225.47817487892715, 388.1553400000001}, {215.49146901456862, 388.15534}, {205.49606113609192, 388.15534}, {195.48133716757894, 388.15534}, {185.4935827776224, 388.15534}, {180.3598, 393.0207321506428}, {180.3598, 403.03608350506784}, {180.3598, 413.0209449982286}, {180.35979999999998, 423.0219101210179}, {180.3598, 433.0202159433902}, {180.3598, 443.0296049050687}, {180.3598, 453.0323798070602}, {180.3598, 463.03226480389316}, {180.3598, 473.0268981357535}, {180.3598, 483.02629308030845}, {180.3598, 493.03229960407873}, {180.3598, 503.03080997494453}, {180.3598, 513.0388574031858}, {180.3598, 523.0385852413004}, {180.3598, 533.0332376506034}, {180.3598, 543.0355257421875}, {180.2448710643997, 553.0208180675215}, {177.19080816225144, 562.4487960907969}, {169.98905458305268, 569.2395561104188}, {160.44170608540497, 571.9452893143915}, {150.6344887028717, 570.4504140202046}, {142.48446173129122, 564.8238788171985}, {138.0354337949882, 555.9861552587286}, {137.39486999999997, 546.029104888508}, {137.39487, 536.0338372639734}, {137.39487, 526.0339818139319}, {137.39487, 516.038971918303}, {137.39486999999997, 506.0346430932794}, {137.39487, 496.03066532765433}, {137.39487, 486.02825201828955}, {137.39487, 476.0283761146055}, {137.39487, 466.0356184365158}, {137.39487, 456.02552560605847}, {137.39487, 446.03839070658995}, {137.39487, 436.0266910260708}, {137.39487, 426.0343573676853}, {137.39487, 416.03314762087217}, {137.39487, 406.0344041973217}, {137.39487, 396.0430303513142}, {135.26643452991485, 388.15534}, {125.2730851355362, 388.15534}};
    static final double[][] MAN = {{462.4893368429512, 106.02037034630584}, {452.533842695348, 106.8526045044277}, {442.8942894183785, 109.39701137757002}, {433.84653417252275, 113.64633104787472}, {425.7120726123034, 119.43514707250812}, {418.6845689420686, 126.53830617950824}, {412.90780467717934, 134.69219771869115}, {408.4754779943647, 143.64390355909177}, {405.4640140163101, 153.1552277264529}, {403.94651278878456, 163.03273382258556}, {403.77713, 173.04247483265877}, {403.77712999999994, 183.03173104344924}, {403.77713, 193.04220530970173}, {403.77712999999994, 203.0277644544431}, {403.77713, 213.04044506626397}, {403.77713, 223.02530434404028}, {403.77713, 233.0290776886619}, {403.77713, 243.03801670060898}, {403.77712999999994, 253.0319269203779}, {403.77713, 263.0305623990767}, {403.77712999999994, 273.02670878058467}, {403.77713, 283.0356139061857}, {403.77713, 293.04216732020774}, {403.77713, 303.0427361509572}, {403.83824559785813, 313.0322983059502}, {406.65872492394254, 322.53811098417276}, {413.7982011867822, 329.3691378301239}, {423.3884781156368, 331.80547870841974}, {433.0493615041353, 329.62736354217526}, {440.4535774533859, 323.0881541687011}, {443.71182733188675, 313.72368909315105}, {443.87777, 303.73495185363765}, {443.87777000000006, 293.72881629891674}, {443.87777, 283.7380054520414}, {443.87777000000006, 273.72225097714494}, {443.87777, 263.72774606558033}, {443.87777, 253.7221911969349}, {443.87777000000006, 243.73339500471036}, {443.87776999999994, 233.72173797748167}, {443.87777000000006, 223.73671613315219}, {443.87777, 213.72143362640017}, {443.87777000000006, 203.72718782350478}, {443.87777, 193.7276915240759}, {443.87777000000006, 183.73036514534792}, {449.2132063235784, 179.06038}, {453.90289, 184.36059849674186}, {453.90288999999996, 194.37196950652068}, {453.90289000000007, 204.36904809194036}, {453.90289, 214.37407841961723}, {453.90289, 224.37344618239774}, {453.90289, 234.35837206116673}, {453.90289, 244.3704365943509}, {453.90289, 254.36440114795317}, {453.90289, 264.37656833529127}, {453.90289, 274.3688228805055}, {453.90289, 284.3687751643829}, {453.90289, 294.3618851665114}, {453.90288999999996, 304.37604338347825}, {453.90289000000007, 314.3687861187696}, {453.90289000000007, 324.36676303607817}, {453.90289, 334.36948324424435}, {453.90289, 344.3629188303328}, {453.90288999999996, 354.36819553161024}, {453.90289, 364.3745830257924}, {453.90288999999996, 374.3717390199125}, {453.90289000000007, 384.3657884976122}, {453.90289, 394.3618307100753}, {453.90288999999996, 404.36301442315136}, {453.90289000000007, 414.36956989985083}, {453.90289, 424.3620584168504}, {453.90289000000007, 434.36345627246305}, {453.90289, 444.3726449372998}, {453.90288999999996, 454.3640836694986}, {453.90289000000007, 464.3720773040645}, {453.90288999999996, 474.3664698627002}, {453.90289, 484.37026486611717}, {453.90289, 494.35842198293915}, {453.90289, 504.3721821425669}, {453.90289, 514.3600552858718}, {453.90289, 524.3676451801086}, {453.90289000000007, 534.3721006405863}, {453.9075642427948, 544.3644381309482}, {455.60590485439303, 554.1832875311162}, {460.65215928920287, 562.7399681118619}, {468.70183868774393, 568.5498821373731}, {478.37174997932743, 570.8666010572595}, {488.24381617730387, 569.6565299020629}, {497.0505542356974, 565.0315405828303}, {503.42775770420695, 557.4306688324574}, {506.5296556936291, 547.9762215382073}, {506.89297, 537.9777933451062}, {506.89297, 527.9871542586234}, {506.89297000000005, 517.9951143767945}, {506.89297, 507.9909738108167}, {506.89296999999993, 497.9907505289346}, {506.89297000000005, 487.98528872174177}, {506.89297000000005, 477.99178321688464}, {506.89297, 467.98772119383125}, {506.89297, 457.9902911172704}, {506.89296999999993, 447.98861544286694}, {506.89297000000005, 437.99369787818284}, {506.89297, 427.9896952980957}, {506.89297, 417.9795407630701}, {506.89297, 407.9908884885605}, {506.89297, 397.98894426367394}, {506.89297, 387.9840138409639}, {506.89297, 377.9919815208706}, {506.89297, 367.98660988061044}, {506.89297, 357.9830947363158}, {506.89297, 347.9902876529847}, {506.89297, 337.98193975693846}, {509.778219296084, 330.86906000000005}, {515.48597, 335.15092908833435}, {515.48597, 345.1675265987539}, {515.48597, 355.1576725680459}, {515.48597, 365.15958624150034}, {515.48597, 375.15752112297275}, {515.48597, 385.1614575134151}, {515.48597, 395.1650973033075}, {515.48597, 405.1510659141893}, {515.48597, 415.15488226888687}, {515.48597, 425.16843083057665}, {515.48597, 435.16058266399176}, {515.48597, 445.16613104554347}, {515.48597, 455.1630598394037}, {515.48597, 465.1625482222002}, {515.48597, 475.16223079589116}, {515.48597, 485.1546736566054}, {515.48597, 495.1616345477305}, {515.48597, 505.1634162637858}, {515.48597, 515.1593247234044}, {515.48597, 525.1669060335787}, {515.48597, 535.1595594574615}, {515.6038694586316, 545.1567497177639}, {517.9724124655529, 554.8351850505253}, {523.5748962494384, 563.0292314798724}, {531.8507006288364, 568.5635608495047}, {541.5184380746764, 570.8509882865387}, {551.4202702289778, 569.7557446720009}, {560.2492347697628, 565.2012780124378}, {566.579993317863, 557.5547867169585}, {569.5737322270678, 548.0629795303987}, {569.90817, 538.0793547841556}, {569.90817, 528.0894774110359}, {569.90817, 518.0755869223838}, {569.90817, 508.07252700883305}, {569.90817, 498.0867338403676}, {569.90817, 488.0734657284515}, {569.90817, 478.08235689340023}, {569.90817, 468.0893054780643}, {569.9081700000002, 458.0861506192185}, {569.90817, 448.08379282982855}, {569.90817, 438.0845043776122}, {569.9081699999999, 428.07333776811595}, {569.9081700000002, 418.0855099722745}, {569.9081700000002, 408.0854004674472}, {569.9081700000002, 398.0778538985479}, {569.90817, 388.0800724588957}, {569.90817, 378.0734037196561}, {569.9081699999999, 368.0865237214454}, {569.90817, 358.0804189002898}, {569.90817, 348.0820219335551}, {569.9081700000002, 338.085196093918}, {569.90817, 328.0848100038019}, {569.90817, 318.07766213515674}, {569.90817, 308.0794585991182}, {569.90817, 298.07726253480485}, {569.9081699999999, 288.07958184750487}, {569.90817, 278.08617905688163}, {569.90817, 268.07717774008995}, {569.90817, 258.07671597874844}, {569.90817, 248.08404406145218}, {569.90817, 238.0875140753838}, {569.9081699999999, 228.0725276181526}, {569.90817, 218.0762348958001}, {569.90817, 208.08035013453446}, {569.90817, 198.0741511062613}, {569.90817, 188.07510108159147}, {570.8876778758007, 179.06038000000004}, {579.93333, 180.008308340403}, {579.93333, 190.01105701683937}, {579.93333, 200.01070215156585}, {579.93333, 210.01431926957753}, {579.93333, 220.01607849361343}, {579.93333, 230.0252151844701}, {579.93333, 240.02204694793386}, {579.93333, 250.0256394933388}, {579.9333300000001, 260.01895372438025}, {579.93333, 270.00948114935954}, {579.93333, 280.01052872832554}, {579.93333, 290.01404295957104}, {579.93333, 300.008532237579}, {579.93333, 310.0116266139333}, {581.4095299080797, 319.8382209159255}, {587.2359106177994, 327.81095046382904}, {596.3233724690349, 331.7106842374325}, {606.2122937611211, 330.9243265718627}, {614.5581471517387, 325.62042986365316}, {619.2374373720412, 316.89426449769735}, {620.0338899999999, 306.9696781056633}, {620.03389, 296.95660523772625}, {620.03389, 286.9686750996535}, {620.0338900000002, 276.9694452628133}, {620.03389, 266.97370993723433}, {620.03389, 256.95570056816223}, {620.03389, 246.95966348013667}, {620.03389, 236.95609822505367}, {620.03389, 226.96588327695542}, {620.0338899999999, 216.96504230923824}, {620.0338899999999, 206.96243322734887}, {620.03389, 196.97385631766258}, {620.03389, 186.95506101658998}, {620.03389, 176.97227396710232}, {620.0185652830877, 166.96451777549464}, {618.9197242846502, 157.03381046021764}, {616.2804580272212, 147.4009441903722}, {612.2064601666232, 138.28744087569106}, {606.7803754403586, 129.88159274178474}, {600.1320380621942, 122.44274922645464}, {592.3591042139747, 116.16170012552143}, {583.647619487121, 111.2707819259551}, {574.238667961731, 107.94237829483032}, {564.3910396431345, 106.2509276554336}, {554.4032873032405, 106.02037}, {544.3979565515474, 106.02037}, {534.3911419126425, 106.02037000000001}, {524.3968590201598, 106.02037}, {514.3971856513479, 106.02037}, {504.39734886692685, 106.02037}, {494.4009421373297, 106.02037000000001}, {484.3969806854666, 106.02036999999999}, {474.3887469165652, 106.02037}, {464.3975684749571, 106.02037}};

    public static void main(String[] args) {
        Simplify<Point> simplify = new Simplify<>(new Point[0]);

        // here we have an array with hundreds of points
        Point[] woman = toPoints(WOMAN, 0, 0);
        Point[] man = toPoints(MAN, -381, 0);

        Point[] lwoman = simplify.simplify(woman, 1, true);
        Point[] lman = simplify.simplify(man, 1, true);
        BasicStroke pathStroke = new BasicStroke(0.1f);

        Shape awoman = pathStroke.createStrokedShape(toPath2D(lwoman));
        Shape aman = pathStroke.createStrokedShape(toPath2D(lman));
        printToArray(lwoman);
        printToArray(lman);

        JFrame frame = new JFrame("Test");
        frame.setDefaultCloseOperation(WindowConstants.EXIT_ON_CLOSE);
        JComponent jcomponent = new JComponent() {
            @Override
            protected void paintComponent(Graphics g1d) {
                super.paintComponent(g1d);
                Graphics2D g = (Graphics2D) g1d;
                g.setColor(Color.RED);
                g.draw(aman);
                g.setColor(Color.GREEN);
                g.draw(awoman);

            }
        };
        frame.setContentPane(jcomponent);
        frame.setBounds(0, 0, 400, 800);
        frame.setVisible(true);
    }

    private static Point[] toPoints(double[][] array, double x, double y) {
        return Arrays.stream(array).map(p -> new Point() {
            @Override
            public double getX() {
                return p[0] + x;
            }

            @Override
            public double getY() {
                return p[1] + y;
            }
        }).toArray(Point[]::new);
    }

    public static Path2D toPath2D(Point[] points) {
        Path2D path = new Path2D.Double();
        path.moveTo(points[0].getX(), points[0].getY());
        for (int i = 1; i < points.length; i++) {
            path.lineTo(points[i].getX(), points[i].getY());
        }
        path.closePath();
        path.append(new Ellipse2D.Double(84.5, 0, 93, 93), false);
        return path;
    }

    public static void printToArray(Point[] points) {
        String collect = Arrays.stream(points).map(point -> String.format("{%.4ff,%.4ff}", point.getX(), point.getY())).collect(Collectors.joining(","));
        System.out.println("{" + collect + "}");
    }
}
